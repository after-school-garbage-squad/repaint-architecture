# ボーナスの仕様

ボーナスとは、人流制御によりスポットに何かしらの変化が生じることである。

## 人流制御について

人流制御は開始点と、終点があり、開始点の参加者を終点に誘導するのが目的である。
人流制御を行うと、終点のスポットにはボーナスが起こり、開始点のスポットの一定数のランダムな参加者に通知が行われる。

### 人流制御の終了タイミング

- 一定時間が経過した時
  人流制御の開始から一定の時間が経過した時、人流制御の結果がどうであれ、人流制御は終了する。
- 同時に一定数以上の人流制御を行った時
  同時に複数の人流制御を行うと効果が薄くなることが想定されるため、同時に一定数以上の人流制御を同時に行うと、行われた人流制御が古い順に終了する。
- ユーザーの操作により終了した時
  ユーザーが人流制御を終了させた時、人流制御は終了する。
- [一定数の参加者が終点に到達した時](#一定数の参加者が終点に到達した時)

#### 一定数の参加者が終点に到達した時

一定数の参加者が終点に到達した時、人流制御は終了する。
この一定数とは、
訪れた参加者数>max(開始点の開始時点の参加者数*0.4, max(開始時の終点の参加者数, 5)*1.5)
と定義する。

なお訪れた参加者数は、人流制御を開始した後から終点のスポットに入った参加者の**総数**と定義する。

> **Warning**
> 現在の参加者数ではないことに注意する。

## ボーナスについて

ボーナスは、終点のスポットに起こる。

### ボーナスによって起こること

ボーナスのスポットに入ると、ユーザー固有のクールタイムが通常時に比べて減少し、パレットのドロップがしやすくなる。
