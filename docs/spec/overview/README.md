# 全体的な仕様

## 旧仕様書より

- mobile
  - イベント参加 QR スキャン
    - 読み込む QR コードの種類でアプリの遷移先（参加者用・運営用）を切り替える
    - イベント参加用 QR
      - イベントに対して一意な QR
        - QR を読んでデフォの画像などを受信する際にサーバーから振られた一意な ID を振り、個体識別する
        - https://qiita.com/yutao727/items/0d503c45bcbe18b27ec3
    - 運営ログイン用 QR
      - ワンタイム QR
      - デバイスの名前をサーバーに登録
  - 参加者
    - HP などへの導線
      - サーバーから送信されてきた URL を表示する
    - 通知
      - 通知は全てサーバーから降ってくる
        - パレット取得スポットに入った通知
        - 運営による手動の通知
        - スケジュールに従った自動通知
    - 画像表示
      - 途中結果を表示
      - 完成したら DL ボタンを生やす
      - 画像をデフォと撮影したもので選択できる
    - スポット検知
      - スポットに入った、出たことを iBeacon のデータで API に投げる
    - ピック用 QR スキャン
      - 現在入っているスポット情報と QR のデコード結果を API に投げる
    - 参加者 QR 表示
      - 写真撮影用に参加者識別 QR を表示
    - アカウント情報の削除
      - 全てのデータを削除
    - それぞれの項目に対して通知をカスタマイズできるようにする
  - 運営
    - スポット管理
      - ビーコンの ID と登録する対象のイベントを投げる
      - ビーコンに名前をつける
      - 登録済みのビーコンの UUID に紐づいている名前の確認
      - ビーコンと QR コードの紐付け確認
    - 写真撮影
      - 撮影した写真と参加者の ID を投げる
      - 撮影した写真を確認、破棄
- web
  - 人流制御
    - 人流の可視化
      - ビーコンごとに人数がどれくらい集まってるか分かる
      - 10 秒間隔でその間に訪れた人数を数字で表示する
        - ビーコンに紐付いた人数の情報をサーバーから取得する
    - スポットごとの拾える量の設定
      - スポット A（例：過密なスポット）からスポット B（例：過疎なスポット）を選んで過疎側の拾える量を変化させる
      - パレットの量が変化した際に一部の人に通知が行く
        - 「一部の人」とは、スポットＡにいるユーザーの一部である
      - 終了タイミングは、B にいる人間が A の n%になるまで、または増加イベントの時間制限がくるまで
  - 認証
    - 運営ユーザーごとにイベントを紐付ける
      - イベントと運営アカウントは一対多で結びつく
      - Auth0 の uuid をサーバーに post する
  - イベント参加用 QR と運営ログイン QR を出す
    - サーバーから帰ってきた画像を表示する
  - イベント作成
    - イベント名の設定
  - 作成したイベントに対しての設定
    - ホームページの URL をサーバーに登録
    - タイムスケジュールをサーバーに登録
    - デフォルトの画像をサーバーに登録
    - メールアドレスをサーバーに登録
  - ビーコン管理
    - スポットに対して QR を発行する
    - スポット一覧を名前と一緒に表示する
  - タイムテーブルに設定されている時間によって通知をする
  - 手動通知ストリーミング
    - ぽっと出のイベントの通知
- server

[エンドポイント](https://docs.google.com/document/u/0/d/1taBjFNSsjwilMK2FhlFNl0VWmqxwDCAl_fy2ugBUgjI/edit)
